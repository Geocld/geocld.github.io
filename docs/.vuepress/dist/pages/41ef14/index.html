<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>RESTful API的前后端分离实现 | lijiahao&#39;s blog</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="前端，移动端和杂七杂八的技术分享">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <link rel="preload" href="/assets/css/0.styles.37c655b2.css" as="style"><link rel="preload" href="/assets/js/app.a9bdc083.js" as="script"><link rel="preload" href="/assets/js/2.e5ef3fc2.js" as="script"><link rel="preload" href="/assets/js/21.616e69cf.js" as="script"><link rel="prefetch" href="/assets/js/10.8d5d773f.js"><link rel="prefetch" href="/assets/js/11.23d9ff22.js"><link rel="prefetch" href="/assets/js/12.e59f6391.js"><link rel="prefetch" href="/assets/js/13.3e7141e6.js"><link rel="prefetch" href="/assets/js/14.fe486314.js"><link rel="prefetch" href="/assets/js/15.dbb9d75f.js"><link rel="prefetch" href="/assets/js/16.5d434c0a.js"><link rel="prefetch" href="/assets/js/17.da2946ee.js"><link rel="prefetch" href="/assets/js/18.36e8b01d.js"><link rel="prefetch" href="/assets/js/19.9b3b9de6.js"><link rel="prefetch" href="/assets/js/20.193b4724.js"><link rel="prefetch" href="/assets/js/22.3437dd07.js"><link rel="prefetch" href="/assets/js/23.9800f0eb.js"><link rel="prefetch" href="/assets/js/24.e5a8a296.js"><link rel="prefetch" href="/assets/js/25.6d348e84.js"><link rel="prefetch" href="/assets/js/26.c37cea17.js"><link rel="prefetch" href="/assets/js/27.53a95692.js"><link rel="prefetch" href="/assets/js/28.15b0cfe6.js"><link rel="prefetch" href="/assets/js/29.862a718b.js"><link rel="prefetch" href="/assets/js/3.a285842d.js"><link rel="prefetch" href="/assets/js/30.b9a503f5.js"><link rel="prefetch" href="/assets/js/31.a206f84e.js"><link rel="prefetch" href="/assets/js/32.1a84dedf.js"><link rel="prefetch" href="/assets/js/33.f76a3db5.js"><link rel="prefetch" href="/assets/js/34.c37860e7.js"><link rel="prefetch" href="/assets/js/35.03d6ab39.js"><link rel="prefetch" href="/assets/js/36.04a82eac.js"><link rel="prefetch" href="/assets/js/37.6318c57b.js"><link rel="prefetch" href="/assets/js/38.2b9b710b.js"><link rel="prefetch" href="/assets/js/39.569b7614.js"><link rel="prefetch" href="/assets/js/4.b2670b76.js"><link rel="prefetch" href="/assets/js/40.4bc8a30b.js"><link rel="prefetch" href="/assets/js/41.9e28cdcc.js"><link rel="prefetch" href="/assets/js/42.6a82f95a.js"><link rel="prefetch" href="/assets/js/43.3f8a62bd.js"><link rel="prefetch" href="/assets/js/44.7fa8ad87.js"><link rel="prefetch" href="/assets/js/45.7353d595.js"><link rel="prefetch" href="/assets/js/46.5b899020.js"><link rel="prefetch" href="/assets/js/47.6d30e01d.js"><link rel="prefetch" href="/assets/js/48.80d902b8.js"><link rel="prefetch" href="/assets/js/49.798c144d.js"><link rel="prefetch" href="/assets/js/5.743f4f71.js"><link rel="prefetch" href="/assets/js/50.75da1fc9.js"><link rel="prefetch" href="/assets/js/6.cc8be4ba.js"><link rel="prefetch" href="/assets/js/7.4906c9c9.js"><link rel="prefetch" href="/assets/js/8.44bf5540.js"><link rel="prefetch" href="/assets/js/9.68f02dbc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.37c655b2.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open no-sidebar"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">lijiahao's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Geocld" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Geocld" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <!----> </aside> <div><main class="page"> <div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-14888ed5><div class="articleInfo" data-v-14888ed5><ul class="breadcrumbs" data-v-14888ed5><li data-v-14888ed5><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-14888ed5></a></li> <li data-v-14888ed5><a href="/categories/?category=%E6%8A%80%E6%9C%AF" title="分类" data-v-14888ed5>技术</a></li> <!----></ul> <div class="info" data-v-14888ed5><div title="作者" class="author iconfont icon-touxiang" data-v-14888ed5><a href="https://github.com/geocld" target="_blank" title="作者" class="beLink" data-v-14888ed5>lijiahao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-14888ed5><a href="javascript:;" data-v-14888ed5>2016-08-27</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          RESTful API的前后端分离实现
        </h1> <div class="theme-vdoing-content content__default"><p>在配合后端进行页面开发时，在非MVC时代，页面配合后端数据通常采用的是后端模板（如smarty、jinja等）+前端html进行开发，例如以下代码</p> <p><img src="http://pics.hitour.cc/430ed9860e7fa6921b333f0be7597052.png" alt=""></p> <p>也就是采用的是前后端耦合的方式将后端数据渲染出来，这样的方式使得前端页面代码可读性差，在后端数据发生结构变化时，前端还得配合后端数据模板进行修改。使得页面的可维护性大大下降、开发效率下降，个人不是很喜欢这样的开发模式，相比之下，使用RESTful服务器为前端提供API进行页面开发是当前较为推荐的前后端分离模式。</p> <p>##什么是REST？
REST (REpresentational State Transfer) 是Web服务实现方案之一，近年来因其简介的设计模式而被广泛采用，如今REST已经变成了web services 和 web APIs 的标配。</p> <p>REST系统有如下特点：</p> <ul><li>客户端-服务器：客户端与服务器隔离，服务器提供服务，客户端进行消费；</li> <li>无状态：从客户端到服务器的每个请求都必须包含理解请求所必需的信息。也就是说，服务器不会存储客户端上一次请求的信息用来给下一次使用。</li> <li>可缓存：服务器必须明示客户端请求能否缓存。</li> <li>分层系统: 客户端和服务器之间的通信应该以一种标准的方式，就是中间层代替服务器做出响应的时候，客户端不需要做任何变动。</li> <li>统一的接口: 服务器和客户端的通信方法必须是统一的。</li> <li>按需编码: 服务器可以提供可执行代码或脚本，为客户端在它们的环境中执行。这个约束是唯一一个是可选的。</li></ul> <p>##建立一个web service服务器
了解了REST系统，接下来就是通过REST<code>客户端-服务器</code>的特点建立一个web service服务器，为前端工作提供API接口。</p> <p>本文使用的是Python的Flask框架进行REST服务器搭建。这个服务器实现了页面端通过API接口以GET、POST等HTTP标准方法进行请求、响应，并将结果以JSON数据的形式返回，从而实现页面应用的开发。</p> <h5>1.设置页面根路径</h5>
开发之前需要在服务器端设置页面的根路由，以便在打开指定页面地址时能打开对应的页面，本文以`static`目录下的`index.html`文件作为根路由显示文件：
<div class="language- extra-class"><pre><code>#设置根路由
@app.route('/')
def root():
	return app.send_static_file('index.html')
</code></pre></div><p>运行服务器，打开<code>http://127.0.0.1:5000/</code>即可看到index.html的页面内容。</p> <h5>2.GET API访问数据</h5> <p>根路由创建并且可以访问到<code>index.html</code>文件后，接下来就可以利用前端AJAX请求来获取服务器的数据了，因为本文不涉及数据库的使用和操作，所以我将服务器数据内容静态的写在<code>app.py</code>中，数据是一个tasks任务的json数据：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#模拟json数据</span>
tasks <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">u'Buy groceries'</span><span class="token punctuation">,</span>
        <span class="token string">'description'</span><span class="token punctuation">:</span> <span class="token string">u'Milk, Cheese, Pizza, Fruit, Tylenol'</span><span class="token punctuation">,</span>
        <span class="token string">'done'</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">u'Learn Python'</span><span class="token punctuation">,</span>
        <span class="token string">'description'</span><span class="token punctuation">:</span> <span class="token string">u'Need to find a good Python tutorial on the web'</span><span class="token punctuation">,</span>
        <span class="token string">'done'</span><span class="token punctuation">:</span> <span class="token boolean">False</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>该tasks数据有几个字段，分别是：<code>id</code>作为每个task的唯一标识符，在后续的修改操作尤其重要；<code>title</code>是task的标题；<code>description</code>是task的具体内容；<code>done</code>表示task是否已完成。</p> <p>前端页面为了获取数据，可直接采用<code>GET</code>方式请求内容，这里将接口命名为<code>/todo/api/tasks</code>，请求方式为<code>GET</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#GET方法api</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/todo/api/tasks'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">getTasks</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'tasks'</span><span class="token punctuation">:</span> tasks<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>为了验证刚才模拟的tasks数据可以访问，在前端页面还没开发时，可以直接访问<code>/todo/api/tasks</code>查看数据：运行服务器，访问<code>http://127.0.0.1:5000/todo/api/tasks</code>可以直接查看json数据。</p> <h5>3.POST API数据修改数据</h5> <p>用户在进行页面访问时，有可能需要对当前数据库内容进行新增或者删除，此时需要开发一个POST请求的API，可接受前端AJAX参数进行进一步的数据库读取操作。首先是新增tasks任务，API接口名字为<code>/todo/api/addTask</code>，方法为<code>POST</code>：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#POST方法API，添加数据项</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/todo/api/addTask'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">pass</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>结合tasks的数据结构，为了新增task任务，需要有以下参数进行标识：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>task <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">'id'</span> <span class="token punctuation">:</span> tasks<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token string">'title'</span><span class="token punctuation">:</span> request<span class="token punctuation">.</span>json<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token string">'description'</span> <span class="token punctuation">:</span> request<span class="token punctuation">.</span>json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'description'</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token string">'done'</span> <span class="token punctuation">:</span> <span class="token boolean">False</span>
	<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>其中<code>request</code>就是页面AJAX的请求信息。</p> <p>整合了AJAX的请求信息就可以直接插入现有的数据库中了，完整的POST新增task的代码如下：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#POST方法API，添加数据项</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/todo/api/addTask'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">add_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> request<span class="token punctuation">.</span>json<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">:</span>
		abort<span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">)</span>
	task <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string">'id'</span> <span class="token punctuation">:</span> tasks<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
		<span class="token string">'title'</span><span class="token punctuation">:</span> request<span class="token punctuation">.</span>json<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
		<span class="token string">'description'</span> <span class="token punctuation">:</span> request<span class="token punctuation">.</span>json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'description'</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token string">'done'</span> <span class="token punctuation">:</span> <span class="token boolean">False</span>
	<span class="token punctuation">}</span>
	tasks<span class="token punctuation">.</span>append<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
    <span class="token comment">#tasks变动后返回新数据到页面，状态码201</span>
	<span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'tasks'</span><span class="token punctuation">:</span> tasks<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">201</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>同理，如果需要删除tasks中的某一项，需要以task的id作为标识符，请求方式同样为<code>POST</code>:</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#POST方法API，删除数据项</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/todo/api/deleteTask'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">delete_task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	task_id <span class="token operator">=</span> request<span class="token punctuation">.</span>json<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span>
	<span class="token keyword">for</span> task <span class="token keyword">in</span> tasks<span class="token punctuation">:</span>
		<span class="token keyword">if</span> task<span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">]</span> <span class="token operator">==</span> task_id<span class="token punctuation">:</span>
			tasks<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>task<span class="token punctuation">)</span>
			<span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'tasks'</span><span class="token punctuation">:</span> tasks<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">201</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5>4.404错误</h5> <p>如果前端访问一个不存在的接口，需要抛出404错误提示：</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#404</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>errorhandler</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">not_found</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">return</span> make_response<span class="token punctuation">(</span>jsonify<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'error'</span><span class="token punctuation">:</span> <span class="token string">'Not found'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">404</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>##API在前端的调用与渲染</p> <p>前端调用无非就是使用AJAX进行数据请求，AJAX可以使用<code>XMLHttpRequest</code>、<code>$ajax()</code>等多种方式进行请求。本文使用的是MVVM框架vue.js进行接口调用并渲染页面，接口调用使用<code>vue-resource</code>的<code>$http()</code>方法。</p> <p>首先在页面加载时访问接口，并将接口返回的数据渲染到页面上：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>data<span class="token operator">:</span> <span class="token punctuation">{</span>
    tasks<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">compiled</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
	<span class="token comment">//在编译后即调用API接口取得服务器端数据</span>
	self<span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/todo/api/tasks'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		self<span class="token punctuation">.</span>tasks <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tasks<span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>视图模型如下：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>task in tasks<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        {{ task.id }}
        {{ task.title }}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteTask(task.id)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>x<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
        {{ task.description }}
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>new_task.title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">cols</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rows</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>new_task.description<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>		<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addTask<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>add<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>在视图模型中我还加入了可以添加、删除数据的操作<code>addTask</code>、<code>deleteTask</code>,对应的接口调用方法如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>methods<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">addTask</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	<span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
      	self<span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/todo/api/addTask'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      		title<span class="token operator">:</span> self<span class="token punctuation">.</span>new_task<span class="token punctuation">.</span>title<span class="token punctuation">,</span>
      		description<span class="token operator">:</span> self<span class="token punctuation">.</span>new_task<span class="token punctuation">.</span>description
      	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      	self<span class="token punctuation">.</span>tasks <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tasks<span class="token punctuation">;</span>
      	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">deleteTask</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> self <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            self<span class="token punctuation">.</span>$http<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token string">'/todo/api/deleteTask'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
              id<span class="token operator">:</span> id
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              self<span class="token punctuation">.</span>tasks <span class="token operator">=</span> res<span class="token punctuation">.</span>data<span class="token punctuation">.</span>tasks<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>此时再打开<code>http://127.0.0.1:5000/</code>就可以看到数据渲染、添加、删除等一系列前端效果，至此一个简单的前后端分离的实践已经结束。</p> <p>##路由</p> <p>有了API接口，在多页面的情况下可以直接使用前端路由进行页面切换，将路由命名、规则完全交给前端。</p> <p>##总结</p> <p>本文通过Python的Flask框架搭建了一个可以响应GET、POST请求的RESTful服务器，为前端页面提供了相应的操作API接口，同时使用vue.js进行数据请求和渲染，展现了前端页面如何调用API接口，可以看到使用RESTful API进行前后端分离有以下优点：</p> <ol><li>不再使用后端模板语言，前端页面代码可读性大大提高，维护性也大大提高；</li> <li>通过前后端分离，具有数据交互的页面当做SPA开发，前端工程师可以更加专注的开发高性能、用户体验良好的页面；后端工程师只需为前端提供API接口，可以将更多的精力专注与后端的工作，前后端的业务专注度也有很大的提高；</li> <li>如果使用MVVM框架进行页面开发，通过API数据响应可以自动更新dom，不需要开发者直接操作dom，也提高了页面的可维护性。</li></ol> <p>本文完整代码可直接到<a href="https://github.com/Geocld/RESRful-API-with-vuejs" target="_blank" rel="noopener noreferrer">RESRful-API-with-vuejs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>进行查看，由于本人对部分知识了解不深，在文章里也写的比较肤浅，还请各位批评指正。</p> <p>（完）</p></div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Python" title="标签">
      #Python
    </a><a href="/tags/?tag=vue-js" title="标签">
      #vue.js
    </a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2020/08/08, 16:08:00</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/658815/"><div>react-native run-ios内部原理探索</div></a> <span>03-05</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/3ffe0e/"><div>Android电话监听功能开发及注意事项</div></a> <span>01-22</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/85ee6e/"><div>关于Rom Hacking你可以了解到的一些事</div></a> <span>01-16</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div> </main></div> <div class="footer"><div class="icons"><a href="mailto:lijiahao53@gmail.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/geocld" title="GitHub" target="_blank" class="iconfont icon-github"></a></div> 
  Theme by <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
     | Copyright © 2015-2020
    <span>lijiahao | <a href="https://github.com/xugaoyi/vuepress-theme-vdoing/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a9bdc083.js" defer></script><script src="/assets/js/2.e5ef3fc2.js" defer></script><script src="/assets/js/21.616e69cf.js" defer></script>
  </body>
</html>